(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,t,n){e.exports=n(20)},18:function(e,t,n){},20:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(10),i=n.n(s),o=(n(18),n(1)),l=n(2),u=n(4),c=n(3),h=n(5),d=n(6),m="https://sql-sensei.herokuapp.com",p=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(u.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).state={showButtons:!0,action:null,username:"",pword:"",confpword:"",error:null},n.handleChange=function(e){n.setState(Object(d.a)({},e.target.id,e.target.value))},n.handleSubmit=function(e){e.preventDefault();var t=m,a={};"create"===n.state.action?(t+="/users",a={username:n.state.username,password:n.state.pword,password_confirmation:n.state.confpword}):(t+="/users/login",a={username:n.state.username,password:n.state.pword}),fetch(t,{body:JSON.stringify(a),method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){return n.handleResponse(e)}).catch(function(e){return console.log(e)})},n.handleResponse=function(e){e.password?n.setState({error:"Please check your password and try again"}):e.message?n.setState({error:e.message}):"has already been taken"===e.username[0]?n.setState({error:"That username has already been taken. Try another one!"}):e.user_id&&(n.setState({showButtons:!0,action:null,username:"",pword:"",confpword:"",error:null}),n.props.setSession(e))},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"account"},r.a.createElement("h2",null,"Create an Account or Log In to train with The Sensei"),this.state.showButtons?r.a.createElement("div",{className:"account-actions"},r.a.createElement("button",{onClick:function(){e.setState({action:"create",showButtons:!1})}},"Create Account"),r.a.createElement("button",{onClick:function(){e.setState({action:"login",showButtons:!1})}},"Log In")):null,"create"===this.state.action?r.a.createElement("div",{className:"create-account"},r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("input",{id:"username",type:"text",value:this.state.username,placeholder:"username",onChange:this.handleChange}),r.a.createElement("input",{id:"pword",type:"password",value:this.state.pword,placeholder:"password",onChange:this.handleChange}),r.a.createElement("input",{id:"confpword",type:"password",value:this.state.confpword,placeholder:"confirm password",onChange:this.handleChange}),r.a.createElement("input",{type:"submit",value:"Create Account"})),""!==this.state.error?r.a.createElement("p",null,this.state.error):null,r.a.createElement("p",{onClick:function(){e.setState({action:"login",showButtons:!1})}},"Log In to an existing account")):null,"login"===this.state.action?r.a.createElement("div",{className:"log-in"},r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("input",{id:"username",type:"text",value:this.state.username,placeholder:"username",onChange:this.handleChange}),r.a.createElement("input",{id:"pword",type:"password",value:this.state.pword,placeholder:"password",onChange:this.handleChange}),r.a.createElement("input",{type:"submit",value:"Log In"})),""!==this.state.error?r.a.createElement("p",null,this.state.error):null,r.a.createElement("p",{onClick:function(){e.setState({action:"create",showButtons:!1})}},"Can't Log In? Create an Account")):null)}}]),t}(a.Component);function g(e){var t={situationHeader:"",situationBody:[],ninjaMoves:""};switch(e){case"joinTraining1":t.situationHeader="2 Tables:",t.situationBody=["friends","spirit_animals"],t.ninjaMoves="Find Chris Dirt Stevens' spirit animal! The correct ninja move must return only 1 row.";break;case"joinTraining2":t.situationHeader="2 Tables:",t.situationBody=["friends","spirit_animals"],t.ninjaMoves="Find which friend doesn't have a spirit animal! The correct ninja move must return only 1 row.";break;case"joinTraining3":t.situationHeader="4 Tables:",t.situationBody=["friends","spirit_animals","friends_music","bands"],t.ninjaMoves="Your friend's spirit animal is a mallard. Find their favorite bands!";break;case"joinTraining4":t.situationHeader="3 Tables:",t.situationBody=["friends","friends_music","bands"],t.ninjaMoves="Find the bands that none of your friends like!";break;default:return null}return t}function f(e){return e=(e=(e=e.toLowerCase()).replace(/\n/g," ")).replace(/\\/g,""),/;$/.test(e)||(e+=";"),/^select/i.test(e)?/from/i.test(e)?/friends/i.test(e)||/spirit_animals/i.test(e)||/friends_music/i.test(e)||/bands/i.test(e)?/top \d|top\d/.test(e)?{syntax:!1,error:"Remember in PostgreSQL, use LIMIT rather than TOP."}:{syntax:!0,query:e}:{syntax:!1,error:"Check your query. What table are you selecting from?"}:{syntax:!1,error:"Make sure you're selecting FROM somthing"}:{syntax:!1,error:"Make sure your query begins with SELECT"}}var y=n(7),v=n.n(y),b=n(11),E="";function S(){return(S=Object(b.a)(v.a.mark(function e(t,n){var a,r;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return w(t,n),a=new Promise(function(e,t){setTimeout(function(){return e(E)},100)}),e.next=4,a;case 4:return r=e.sent,console.log("promise: ",a),console.log("evaluate response: ",r),e.abrupt("return",r);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}var w=function(e,t){var n=f(t);if(!n.syntax)return!1;fetch("http://localhost:3000/query",{body:JSON.stringify({query_statement:n.query}),method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(t){var n=j(e,t);console.log("response from checkResponse: ",n),console.log("setting globalDecision to: ",n),E=n}).catch(function(e){return console.log(e)})},j=function(e,t){if(t.syntax){var n=T(e,t);return console.log("response from checkAnswer: ",n),n}return!1},T=function(e,t){switch(e){case"joinTraining1":return 1===t.results.length&&"ferret"===t.results[0].spirit_animal;case"joinTraining2":return 1===t.results.length&&"Sandwich Waverly"===t.results[0].friend_name;case"joinTraining3":if(3===t.results.length&&t.results[0].band_name){for(var n=[],a=0;a<t.results.length;a++)n.push(t.results[a].band_name);return!!(n.includes("Slipknot")&&n.includes("Carlos Santana")&&n.includes("Lady Gaga"))}return!1;case"joinTraining4":if(14===t.results.length&&t.results[0].band_name){console.log("TRUTH CONDITION");for(var r=[],s=0;s<t.results.length;s++)r.push(t.results[s].band_name);return console.log(r),!!(r.includes("Limp Bizkit")&&r.includes("Waylon Jennings")&&r.includes("Guns N' Roses")&&r.includes("Phil Collins")&&r.includes("Madonna")&&r.includes("Coldplay")&&r.includes("The Who")&&r.includes("White Stripes")&&r.includes("Velvet Revolver")&&r.includes("Destiny's Child")&&r.includes("Black Flag")&&r.includes("Bee Gees")&&r.includes("Spinal Tap")&&r.includes("Tool"))}return!1;default:return!1}},C=(n(9),function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(s)))).state={query:"",results:[],error:"",sensei:""},n.handleChange=function(e){n.setState(Object(d.a)({},e.target.id,e.target.value))},n.handleSubmit=function(e){e.preventDefault();var t=f(n.state.query);t.syntax?fetch(m+"/query",{body:JSON.stringify({query_statement:t.query}),method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(n.props.session)}}).then(function(e){return e.json()}).then(function(e){return n.handleResponse(e)}).catch(function(e){return console.log(e)}):n.setState({results:[],error:t.error})},n.handleResponse=function(e){e.syntax?n.setState({results:e.results,error:""}):!1===e.syntax?n.setState({results:[],error:n.handleErrors(e.error)}):e.message?n.setState({results:[],error:"The SQL Sensei says: "+e.message}):n.setState({results:[],error:"The SQL Sensei doesn't like your query. Try again."})},n.handleErrors=function(e){if(/^PG/.test(e)){var t=e.toLowerCase();return"The SQL Sensei spots a syntax error: "+(t=t.replace(/\n/g," ").replace(/\\/g,"").replace(/"/g,"'")).split("error: ")[1].split(" line")[0]}return e},n.getTableHeaders=function(){return Object.keys(n.state.results[0])},n.renderTableHeaders=function(){return n.getTableHeaders().map(function(e,t){return r.a.createElement("th",{key:t},e)})},n.renderTableData=function(){for(var e=n.getTableHeaders(),t=[],a=0;a<n.state.results.length;a++){for(var s=[],i=0;i<e.length;i++)s.push(r.a.createElement("td",{key:i},n.state.results[a][e[i]]));t.push(r.a.createElement("tr",{key:a},s))}return t},n.checkWithTheSensei=function(e,t){(function(e,t){return S.apply(this,arguments)})(e,t).then(function(e){return console.log("Decision in React:",e)})},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"query"},r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("textarea",{id:"query",type:"textarea",placeholder:"write your query",value:this.state.query,onChange:this.handleChange}),r.a.createElement("input",{type:"submit",value:"Test It"})),r.a.createElement("button",{onClick:function(){e.checkWithTheSensei(e.props.training,e.state.query)}},"Prove Yourself to The SQL Sensei!"),r.a.createElement("div",{className:"sensei"},""!==this.state.sensei?r.a.createElement("h4",null,this.state.sensei):null),r.a.createElement("div",{className:"error"},""!==this.state.error?r.a.createElement("h4",null,this.state.error):null),r.a.createElement("div",{className:"results"},this.state.results.length>0?r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,this.renderTableHeaders())),r.a.createElement("tbody",null,this.renderTableData())):null))}}]),t}(a.Component)),k=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(u.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).state={training:"joinTraining1"},n.handleSelect=function(e){n.setState({training:e.target.value})},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,this.props.username," - Choose Your Ninja Level!"),r.a.createElement("button",null,"Joins"),r.a.createElement("button",null,"Aggregate Functions"),r.a.createElement("select",{onChange:this.handleSelect},r.a.createElement("option",{value:"joinTraining1",default:!0},"Ninja Level 1"),r.a.createElement("option",{value:"joinTraining2"},"Ninja Level 2"),r.a.createElement("option",{value:"joinTraining3"},"Ninja Level 3"),r.a.createElement("option",{value:"joinTraining4"},"Ninja Level 4")),r.a.createElement("div",{className:"situation"},r.a.createElement("h4",null,"Situation"),r.a.createElement("h5",null,g(this.state.training).situationHeader),r.a.createElement(r.a.Fragment,null,g(this.state.training).situationBody.map(function(e,t){return r.a.createElement("p",{key:t},e)}))),r.a.createElement("div",{className:"ninja-moves"},r.a.createElement("h4",null,"Your Ninja Moves"),r.a.createElement("p",null,g(this.state.training).ninjaMoves)),r.a.createElement(C,{training:this.state.training,userId:this.props.userId,username:this.props.username,session:this.props.session}))}}]),t}(a.Component),O=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(u.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).state={userId:null,username:null,session:null},n.setSession=function(e){n.setState({userId:e.user_id,username:e.username,session:e.token}),localStorage.setItem("userId",n.state.userId),localStorage.setItem("username",n.state.username),localStorage.setItem("session",n.state.session)},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){null!==localStorage.getItem("session")&&this.setState({userId:localStorage.getItem("userId"),username:localStorage.getItem("username"),session:localStorage.getItem("session")})}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"log-in"},r.a.createElement("h1",null,"SQL SENSEI")),null===this.state.session?r.a.createElement(p,{setSession:this.setSession}):r.a.createElement(k,{userId:this.state.userId,username:this.state.username,session:this.state.session}))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(O,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},9:function(e,t,n){}},[[12,1,2]]]);
//# sourceMappingURL=main.2aba6d69.chunk.js.map