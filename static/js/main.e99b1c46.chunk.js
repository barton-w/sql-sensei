(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{21:function(e,t,n){},27:function(e,t,n){e.exports=n(40)},32:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),r=n(23),i=n.n(r),o=(n(32),n(2)),l=n(3),c=n(5),u=n(4),m=n(6),d=n(14),h=n(10),p=n(13),g="https://sql-sensei.herokuapp.com",v=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={showButtons:!0,action:null,username:"",pword:"",confpword:"",error:null},n.handleChange=function(e){n.setState(Object(p.a)({},e.target.id,e.target.value))},n.handleSubmit=function(e){e.preventDefault();var t=g,a={};"create"===n.state.action?(t+="/users",a={username:n.state.username,password:n.state.pword,password_confirmation:n.state.confpword}):(t+="/users/login",a={username:n.state.username,password:n.state.pword}),fetch(t,{body:JSON.stringify(a),method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){return n.handleResponse(e)}).catch(function(e){return console.log(e)})},n.handleResponse=function(e){e.password?n.setState({error:"Please check your password and try again"}):e.message?n.setState({error:e.message}):"has already been taken"===e.username[0]?n.setState({error:"That username has already been taken. Try another one!"}):e.user_id&&(n.setState({showButtons:!0,action:null,username:"",pword:"",confpword:"",error:null}),n.props.setSession(e))},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"account"},null===this.state.action?s.a.createElement("h3",{id:"account-header"},"Create your Account or Log In to train with The Sensei"):null,this.state.showButtons?s.a.createElement("div",{className:"account-actions"},s.a.createElement("button",{onClick:function(){e.setState({action:"create",showButtons:!1})}},"Create Account"),s.a.createElement("button",{className:"button-primary",onClick:function(){e.setState({action:"login",showButtons:!1})}},"Log In")):null,"create"===this.state.action?s.a.createElement("div",{className:"create-account"},s.a.createElement("h3",{id:"account-header"},"Create your Account, and begin training!"),s.a.createElement("form",{className:"account-form",onSubmit:this.handleSubmit},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"twelve columns"},s.a.createElement("input",{className:"form-field u-full-width",id:"username",type:"text",value:this.state.username,placeholder:"username",onChange:this.handleChange}))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"twelve columns"},s.a.createElement("input",{className:"form-field u-full-width",id:"pword",type:"password",value:this.state.pword,placeholder:"password",onChange:this.handleChange}))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"twelve columns"},s.a.createElement("input",{className:"form-field u-full-width",id:"confpword",type:"password",value:this.state.confpword,placeholder:"confirm password",onChange:this.handleChange}))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"twelve columns"},s.a.createElement("input",{className:"button-primary u-full-width",type:"submit",value:"Create Account"})))),s.a.createElement("p",{id:"account-toggle",onClick:function(){e.setState({action:"login",showButtons:!1,error:null})}},"Log in to an existing account"),""!==this.state.error?s.a.createElement("p",{id:"error"},this.state.error):null):null,"login"===this.state.action?s.a.createElement("div",{className:"log-in"},s.a.createElement("h3",{id:"account-header"},"Log in to continue your training!"),s.a.createElement("form",{className:"account-form",onSubmit:this.handleSubmit},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"twelve columns"},s.a.createElement("input",{className:"form-field u-full-width",id:"username",type:"text",value:this.state.username,placeholder:"username",onChange:this.handleChange}))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"twelve columns"},s.a.createElement("input",{className:"form-field u-full-width",id:"pword",type:"password",value:this.state.pword,placeholder:"password",onChange:this.handleChange}))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"twelve columns"},s.a.createElement("input",{className:"button-primary u-full-width",type:"submit",value:"Log In"})))),s.a.createElement("p",{id:"account-toggle",onClick:function(){e.setState({action:"create",showButtons:!1,error:null})}},"Can't Log In? Create an Account"),""!==this.state.error?s.a.createElement("p",{id:"error"},this.state.error):null):null,s.a.createElement("div",{id:"sensei-image"}))}}]),t}(a.Component);function f(e){var t={situationHeader:"",situationBody:[],ninjaMoves:""};switch(e){case"joinTraining1":t.situationHeader="2 Tables:",t.situationBody=["friends","spirit_animals"],t.ninjaMoves="Find Chris Dirt Stevens' spirit animal! The correct ninja move must return only 1 row.";break;case"joinTraining2":t.situationHeader="2 Tables:",t.situationBody=["friends","spirit_animals"],t.ninjaMoves="Find which friend doesn't have a spirit animal! The correct ninja move must return only 1 row.";break;case"joinTraining3":t.situationHeader="4 Tables:",t.situationBody=["friends","spirit_animals","friends_music","bands"],t.ninjaMoves="Your friend's spirit animal is a mallard. Find their favorite bands!";break;case"joinTraining4":t.situationHeader="3 Tables:",t.situationBody=["friends","friends_music","bands"],t.ninjaMoves="Find the bands that none of your friends like!";break;case"aggregateTraining1":t.situationHeader="1 Table:",t.situationBody=["bands"],t.ninjaMoves="Find the average number of records sold. The correct ninja move must return only 1 row.";break;default:return null}return t}function y(e){return e=(e=(e=e.toLowerCase()).replace(/\n/g," ")).replace(/\\/g,""),/;$/.test(e)||(e+=";"),/^select/i.test(e)?/from/i.test(e)?/friends/i.test(e)||/spirit_animals/i.test(e)||/friends_music/i.test(e)||/bands/i.test(e)?/top \d|top\d/.test(e)?{syntax:!1,error:"Remember in PostgreSQL, use LIMIT rather than TOP."}:{syntax:!0,query:e}:{syntax:!1,error:"Check your query. What table are you selecting from?"}:{syntax:!1,error:"Make sure you're selecting FROM somthing"}:{syntax:!1,error:"Make sure your query begins with SELECT"}}var E=n(16),b=n.n(E),j=n(24),S="";function w(){return(w=Object(j.a)(b.a.mark(function e(t,n,a){var s,r;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return N(t,n,a),s=new Promise(function(e,t){setTimeout(function(){return e(S)},100)}),e.next=4,s;case 4:return r=e.sent,console.log("promise: ",s),console.log("evaluate response: ",r),e.abrupt("return",r);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}var N=function(e,t,n){var a=y(t);if(!a.syntax)return!1;fetch(g+"/query",{body:JSON.stringify({query_statement:a.query}),method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(n)}}).then(function(e){return e.json()}).then(function(t){var n=T(e,t);console.log("response from checkResponse: ",n),console.log("setting globalDecision to: ",n),S=n}).catch(function(e){return console.log(e)})},T=function(e,t){if(t.syntax){var n=C(e,t);return console.log("response from checkAnswer: ",n),n}return!1},C=function(e,t){switch(e){case"joinTraining1":return 1===t.results.length&&"ferret"===t.results[0].spirit_animal;case"joinTraining2":return 1===t.results.length&&"Sandwich Waverly"===t.results[0].friend_name;case"joinTraining3":if(3===t.results.length&&t.results[0].band_name){for(var n=[],a=0;a<t.results.length;a++)n.push(t.results[a].band_name);return!!(n.includes("Slipknot")&&n.includes("Carlos Santana")&&n.includes("Lady Gaga"))}return!1;case"joinTraining4":if(14===t.results.length&&t.results[0].band_name){console.log("TRUTH CONDITION");for(var s=[],r=0;r<t.results.length;r++)s.push(t.results[r].band_name);return console.log(s),!!(s.includes("Limp Bizkit")&&s.includes("Waylon Jennings")&&s.includes("Guns N' Roses")&&s.includes("Phil Collins")&&s.includes("Madonna")&&s.includes("Coldplay")&&s.includes("The Who")&&s.includes("White Stripes")&&s.includes("Velvet Revolver")&&s.includes("Destiny's Child")&&s.includes("Black Flag")&&s.includes("Bee Gees")&&s.includes("Spinal Tap")&&s.includes("Tool"))}return!1;case"aggregateTraining1":if(1===t.results.length){for(var i=Object.values(t.results[0]),o=0;o<i.length;o++)if(/^288229/.test(i[o]))return!0;return!1}return!1;default:return!1}},k=(n(21),function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={query:"",results:[],error:"",sensei:"",senseiMessage:"",approvedQuery:"",saved:"",training:n.props.training},n.handleChange=function(e){n.setState(Object(p.a)({},e.target.id,e.target.value))},n.handleSubmit=function(){var e=y(n.state.query);e.syntax?fetch(g+"/query",{body:JSON.stringify({query_statement:e.query}),method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(n.props.session)}}).then(function(e){return e.json()}).then(function(e){return n.handleResponse(e)}).catch(function(e){return console.log(e)}):n.setState({results:[],error:e.error})},n.handleResponse=function(e){e.syntax?n.setState({results:e.results,error:"",sensei:"",senseiMessage:"",approvedQuery:""}):!1===e.syntax?n.setState({results:[],error:n.handleErrors(e.error),sensei:"",senseiMessage:"",approvedQuery:""}):e.message?n.setState({results:[],error:"The SQL Sensei says: "+e.message,sensei:"",senseiMessage:"",approvedQuery:""}):n.setState({results:[],error:"The SQL Sensei doesn't like your query. Try again.",sensei:"",senseiMessage:"",approvedQuery:""})},n.handleErrors=function(e){if(/^PG/.test(e)){var t=e.toLowerCase();return"The SQL Sensei spots a syntax error: "+(t=t.replace(/\n/g," ").replace(/\\/g,"").replace(/"/g,"'")).split("error: ")[1].split(" line")[0]}return e},n.getTableHeaders=function(){return Object.keys(n.state.results[0])},n.renderTableHeaders=function(){return n.getTableHeaders().map(function(e,t){return s.a.createElement("th",{key:t},e)})},n.renderTableData=function(){for(var e=n.getTableHeaders(),t=[],a=0;a<n.state.results.length;a++){for(var r=[],i=0;i<e.length;i++)r.push(s.a.createElement("td",{key:i},n.state.results[a][e[i]]));t.push(s.a.createElement("tr",{key:a},r))}return t},n.checkWithTheSensei=function(e,t,a){(function(e,t,n){return w.apply(this,arguments)})(e,t,a).then(function(e){e?n.setState({sensei:"correct",senseiMessage:"The Sensei Says: CORRECT!",approvedQuery:n.state.query}):n.setState({sensei:"incorrect",senseiMessage:"The Sensei Says: INCORRECT! Try again.",approvedQuery:""})})},n.saveNinjaMoves=function(){fetch(g+"/solutions",{body:JSON.stringify({solution:n.state.approvedQuery,training:n.props.training,user_id:n.props.userId}),method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(n.props.session)}}).then(function(e){return e.json()}).then(function(e){n.setState({query:n.state.approvedQuery,results:[],error:"",sensei:"",senseiMessage:"",approvedQuery:"",saved:"Saved to your Ninja Moves!"})}).catch(function(e){return console.log(e)})},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.training!==this.state.training&&this.setState({query:"",results:[],error:"",sensei:"",senseiMessage:"",approvedQuery:"",saved:"",training:e.training})}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"query"},s.a.createElement("div",{id:"sensei-image-main"}),s.a.createElement("div",{id:"student-image-main"}),s.a.createElement("form",{id:"query-form"},s.a.createElement("textarea",{id:"query",type:"textarea",placeholder:"write your query",value:this.state.query,onChange:this.handleChange})),s.a.createElement("div",{className:"senseiMessage"},""!==this.state.sensei?s.a.createElement("h4",{className:this.state.sensei},this.state.senseiMessage):null),s.a.createElement("div",{className:"saved"},""!==this.state.saved?s.a.createElement("h4",null,this.state.saved):null),"correct"!==this.state.sensei&&""===this.state.saved?s.a.createElement("div",null,s.a.createElement("button",{onClick:function(){e.handleSubmit()}},"Test It"),s.a.createElement("button",{className:"button-primary",onClick:function(){e.checkWithTheSensei(e.props.training,e.state.query,e.props.session)}},"Prove Yourself to The SQL Sensei!")):s.a.createElement("div",null,""!==this.state.saved?null:s.a.createElement("button",{onClick:this.saveNinjaMoves,className:"button-primary"},"Save the query to your Ninja Moves!")),s.a.createElement("div",{className:"error"},""!==this.state.error?s.a.createElement("h5",null,this.state.error):null),s.a.createElement("div",{className:"results"},this.state.results.length>0?s.a.createElement("table",{id:"query-results"},s.a.createElement("thead",null,s.a.createElement("tr",null,this.renderTableHeaders())),s.a.createElement("tbody",null,this.renderTableData())):null))}}]),t}(a.Component)),O=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={training:"joinTraining1"},n.handleSelect=function(e){n.setState({training:e.target.value})},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"training"},s.a.createElement("div",{className:"choose-move"},s.a.createElement("h4",null,"Choose Your Ninja Move"),s.a.createElement("select",{id:"moves-select",onChange:this.handleSelect},s.a.createElement("option",{value:"joinTraining1",default:!0},"Ninja Move 1"),s.a.createElement("option",{value:"joinTraining2"},"Ninja Move 2"),s.a.createElement("option",{value:"joinTraining3"},"Ninja Move 3"),s.a.createElement("option",{value:"joinTraining4"},"Ninja Move 4"))),s.a.createElement("div",{className:"training-summary"},s.a.createElement("div",{className:"situation"},s.a.createElement("h5",{id:"header"},"Situation"),s.a.createElement("h6",{id:"situation-content"},f(this.state.training).situationHeader),s.a.createElement(s.a.Fragment,null,f(this.state.training).situationBody.map(function(e,t){return s.a.createElement("p",{id:"situation-content",key:t},e)}))),s.a.createElement("div",{className:"ninja-moves"},s.a.createElement("h5",{id:"header"},"Your Ninja Moves"),s.a.createElement("p",{id:"situation-content"},f(this.state.training).ninjaMoves),s.a.createElement("a",{id:"postgres",target:"_blank",rel:"noopener noreferrer",href:"https://www.postgresql.org/docs/9.2/sql-syntax.html"},"PostgreSQL syntax only"))),s.a.createElement(k,{training:this.state.training,userId:this.props.userId,username:this.props.username,session:this.props.session}))}}]),t}(a.Component),M=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={training:"aggregateTraining1"},n.handleSelect=function(e){n.setState({training:e.target.value})},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"training"},s.a.createElement("div",{className:"choose-move"},s.a.createElement("h4",null,"Choose Your Ninja Move"),s.a.createElement("select",{id:"moves-select",onChange:this.handleSelect},s.a.createElement("option",{value:"aggregateTraining1",default:!0},"Ninja Move 1"),s.a.createElement("option",{value:"aggregateTraining2"},"Ninja Move 2"),s.a.createElement("option",{value:"aggregateTraining3"},"Ninja Move 3"),s.a.createElement("option",{value:"aggregateTraining4"},"Ninja Move 4"))),s.a.createElement("div",{className:"training-summary"},s.a.createElement("div",{className:"situation"},s.a.createElement("h5",{id:"header"},"Situation"),s.a.createElement("h6",{id:"situation-content"},f(this.state.training).situationHeader),s.a.createElement(s.a.Fragment,null,f(this.state.training).situationBody.map(function(e,t){return s.a.createElement("p",{id:"situation-content",key:t},e)}))),s.a.createElement("div",{className:"ninja-moves"},s.a.createElement("h5",{id:"header"},"Your Ninja Moves"),s.a.createElement("p",{id:"situation-content"},f(this.state.training).ninjaMoves),s.a.createElement("a",{id:"postgres",target:"_blank",rel:"noopener noreferrer",href:"https://www.postgresql.org/docs/9.2/sql-syntax.html"},"PostgreSQL syntax only"))),s.a.createElement(k,{training:this.state.training,userId:this.props.userId,username:this.props.username,session:this.props.session}))}}]),t}(a.Component),I=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={skill:null,joinClass:"button",aggregateClass:"button"},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement(s.a.Fragment,null,s.a.createElement("h3",null,this.props.username," - Choose Your Ninja Skill!"),s.a.createElement("button",{id:"ninja-skill-button",className:this.state.joinClass,onClick:function(){e.setState({skill:"joins",joinClass:"button-secondary",aggregateClass:"button"})}},"Joins"),s.a.createElement("button",{id:"ninja-skill-button",className:this.state.aggregateClass,onClick:function(){e.setState({skill:"aggregate",joinClass:"button",aggregateClass:"button-secondary"})}},"Aggregate Functions"),"joins"===this.state.skill?s.a.createElement(O,{userId:this.props.userId,username:this.props.username,session:this.props.session}):null,"aggregate"===this.state.skill?s.a.createElement(M,{userId:this.props.userId,username:this.props.username,session:this.props.session}):null)}}]),t}(a.Component),q=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={solutions:[]},n.getSolutions=function(){fetch(g+"/solutions/user",{body:JSON.stringify({user_id:n.props.userId}),method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(n.props.session)}}).then(function(e){return e.json()}).then(function(e){n.setState({solutions:e.solutions})}).catch(function(e){return console.log(e)})},n.deleteSolution=function(e){fetch(g+"/solutions/".concat(e),{body:JSON.stringify({user_id:n.props.userId}),method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(n.props.session)}}).then(function(e){return e.json()}).then(function(e){console.log(e);var t=n.state.solutions;console.log("Solutions Array: ",t);for(var a=0;a<t.length;a++)t[a].id===e.solutions.id&&t.splice(a,1);n.setState({solutions:t})}).catch(function(e){return console.log(e)})},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.getSolutions()}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"saved-ninja-moves"},s.a.createElement("h3",null,"Your Saved Ninja Moves"),this.state.solutions.length>0?s.a.createElement("div",{className:"ninja-moves-list"},this.state.solutions.map(function(t){return s.a.createElement("div",{key:t.id,className:"single-ninja-move"},s.a.createElement("h5",null,t.training),s.a.createElement("p",null,t.solution),s.a.createElement("p",{onClick:function(){e.deleteSolution(t.id)},id:"remove"},"remove"))})):s.a.createElement("h5",null,"Nothing saved yet. Keep training!"))}}]),t}(a.Component),A=(n(34),n(35),function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={userId:null,username:null,session:null},n.setSession=function(e){n.setState({userId:e.user_id,username:e.username,session:e.token}),localStorage.setItem("userId",n.state.userId),localStorage.setItem("username",n.state.username),localStorage.setItem("session",n.state.session)},n.logOut=function(){localStorage.clear(),n.setState({userId:null,username:null,session:null})},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){null!==localStorage.getItem("session")&&this.setState({userId:localStorage.getItem("userId"),username:localStorage.getItem("username"),session:localStorage.getItem("session")})}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"app"},s.a.createElement("h1",{id:"title"},"SQL SENSEI"),null===this.state.session?s.a.createElement(v,{setSession:this.setSession}):s.a.createElement(d.a,null,s.a.createElement("nav",null,s.a.createElement(d.b,{id:"link-cta1",to:"/"},"Train with The Sensei!"),s.a.createElement(d.b,{id:"link-cta2",to:"/ninjamoves"},"View Saved Ninja Moves"),s.a.createElement("a",{id:"link",onClick:this.logOut,href:"/"},this.state.username," | Log Out")),s.a.createElement(h.a,{path:"/",exact:!0,render:function(t){return s.a.createElement(I,Object.assign({},t,{userId:e.state.userId,username:e.state.username,session:e.state.session}))}}),s.a.createElement(h.a,{path:"/ninjamoves",render:function(t){return s.a.createElement(q,Object.assign({},t,{userId:e.state.userId,username:e.state.username,session:e.state.session}))}})))}}]),t}(a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(s.a.createElement(A,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[27,1,2]]]);
//# sourceMappingURL=main.e99b1c46.chunk.js.map