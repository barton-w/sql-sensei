(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{21:function(e,t,a){},27:function(e,t,a){e.exports=a(40)},32:function(e,t,a){},34:function(e,t,a){},35:function(e,t,a){},40:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(23),i=a.n(r),o=(a(32),a(2)),l=a(3),c=a(5),u=a(4),m=a(6),d=a(16),h=a(10),g=a(13),p="http://localhost:3000",v=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={showButtons:!0,action:null,username:"",pword:"",confpword:"",error:null},a.handleChange=function(e){a.setState(Object(g.a)({},e.target.id,e.target.value))},a.handleSubmit=function(e){e.preventDefault();var t=p,n={};"create"===a.state.action?(t+="/users",n={username:a.state.username,password:a.state.pword,password_confirmation:a.state.confpword}):(t+="/users/login",n={username:a.state.username,password:a.state.pword}),fetch(t,{body:JSON.stringify(n),method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){return a.handleResponse(e)}).catch(function(e){return console.log(e)})},a.handleResponse=function(e){e.password?a.setState({error:"Please check your password and try again"}):e.message?a.setState({error:e.message}):"has already been taken"===e.username[0]?a.setState({error:"That username has already been taken. Try another one!"}):e.user_id&&(a.setState({showButtons:!0,action:null,username:"",pword:"",confpword:"",error:null}),a.props.setSession(e))},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"account"},null===this.state.action?s.a.createElement("h3",{id:"account-header"},"Create your Account or Log In to train with The Sensei"):null,this.state.showButtons?s.a.createElement("div",{className:"account-actions"},s.a.createElement("button",{onClick:function(){e.setState({action:"create",showButtons:!1})}},"Create Account"),s.a.createElement("button",{className:"button-primary",onClick:function(){e.setState({action:"login",showButtons:!1})}},"Log In")):null,"create"===this.state.action?s.a.createElement("div",{className:"create-account"},s.a.createElement("h3",{id:"account-header"},"Create your Account, and begin training!"),s.a.createElement("form",{className:"account-form",onSubmit:this.handleSubmit},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"twelve columns"},s.a.createElement("input",{className:"form-field u-full-width",id:"username",type:"text",value:this.state.username,placeholder:"username",onChange:this.handleChange}))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"twelve columns"},s.a.createElement("input",{className:"form-field u-full-width",id:"pword",type:"password",value:this.state.pword,placeholder:"password",onChange:this.handleChange}))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"twelve columns"},s.a.createElement("input",{className:"form-field u-full-width",id:"confpword",type:"password",value:this.state.confpword,placeholder:"confirm password",onChange:this.handleChange}))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"twelve columns"},s.a.createElement("input",{className:"button-primary u-full-width",type:"submit",value:"Create Account"})))),s.a.createElement("p",{id:"account-toggle",onClick:function(){e.setState({action:"login",showButtons:!1,error:null})}},"Log in to an existing account"),""!==this.state.error?s.a.createElement("p",{id:"error"},this.state.error):null):null,"login"===this.state.action?s.a.createElement("div",{className:"log-in"},s.a.createElement("h3",{id:"account-header"},"Log in to continue your training!"),s.a.createElement("form",{className:"account-form",onSubmit:this.handleSubmit},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"twelve columns"},s.a.createElement("input",{className:"form-field u-full-width",id:"username",type:"text",value:this.state.username,placeholder:"username",onChange:this.handleChange}))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"twelve columns"},s.a.createElement("input",{className:"form-field u-full-width",id:"pword",type:"password",value:this.state.pword,placeholder:"password",onChange:this.handleChange}))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"twelve columns"},s.a.createElement("input",{className:"button-primary u-full-width",type:"submit",value:"Log In"})))),s.a.createElement("p",{id:"account-toggle",onClick:function(){e.setState({action:"create",showButtons:!1,error:null})}},"Can't Log In? Create an Account"),""!==this.state.error?s.a.createElement("p",{id:"error"},this.state.error):null):null,s.a.createElement("div",{id:"sensei-image"}))}}]),t}(n.Component);function f(e){var t={situationHeader:"",situationBody:[],ninjaMoves:""};switch(e){case"joinTraining1":t.situationHeader="2 Tables:",t.situationBody=["friends","spirit_animals"],t.ninjaMoves="Find Chris Dirt Stevens' spirit animal! The correct ninja move must return only 1 row.";break;case"joinTraining2":t.situationHeader="2 Tables:",t.situationBody=["friends","spirit_animals"],t.ninjaMoves="Find which friend doesn't have a spirit animal! The correct ninja move must return only 1 row.";break;case"joinTraining3":t.situationHeader="4 Tables:",t.situationBody=["friends","spirit_animals","friends_music","bands"],t.ninjaMoves="Your friend's spirit animal is a mallard. Find their favorite bands!";break;case"joinTraining4":t.situationHeader="3 Tables:",t.situationBody=["friends","friends_music","bands"],t.ninjaMoves="Find the bands that none of your friends like!";break;case"aggregateTraining1":t.situationHeader="1 Table:",t.situationBody=["bands"],t.ninjaMoves="Find the average number of records sold. The correct ninja move must return only 1 row.";break;default:return null}return t}function y(e){return e=(e=(e=e.toLowerCase()).replace(/\n/g," ")).replace(/\\/g,""),/;$/.test(e)||(e+=";"),/^select/i.test(e)?/from/i.test(e)?/friends/i.test(e)||/spirit_animals/i.test(e)||/friends_music/i.test(e)||/bands/i.test(e)?/top \d|top\d/.test(e)?{syntax:!1,error:"Remember in PostgreSQL, use LIMIT rather than TOP."}:{syntax:!0,query:e}:{syntax:!1,error:"Check your query. What table are you selecting from?"}:{syntax:!1,error:"Make sure you're selecting FROM somthing"}:{syntax:!1,error:"Make sure your query begins with SELECT"}}var E=a(15),b=a.n(E),j=a(24),w="";function S(){return(S=Object(j.a)(b.a.mark(function e(t,a,n){var s,r;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return N(t,a,n),s=new Promise(function(e,t){setTimeout(function(){return e(w)},100)}),e.next=4,s;case 4:return r=e.sent,console.log("promise: ",s),console.log("evaluate response: ",r),e.abrupt("return",r);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}var N=function(e,t,a){var n=y(t);if(!n.syntax)return!1;fetch(p+"/query",{body:JSON.stringify({query_statement:n.query}),method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(a)}}).then(function(e){return e.json()}).then(function(t){var a=C(e,t);console.log("response from checkResponse: ",a),console.log("setting globalDecision to: ",a),w=a}).catch(function(e){return console.log(e)})},C=function(e,t){if(t.syntax){var a=T(e,t);return console.log("response from checkAnswer: ",a),a}return!1},T=function(e,t){switch(e){case"joinTraining1":return 1===t.results.length&&"ferret"===t.results[0].spirit_animal;case"joinTraining2":return 1===t.results.length&&"Sandwich Waverly"===t.results[0].friend_name;case"joinTraining3":if(3===t.results.length&&t.results[0].band_name){for(var a=[],n=0;n<t.results.length;n++)a.push(t.results[n].band_name);return!!(a.includes("Slipknot")&&a.includes("Carlos Santana")&&a.includes("Lady Gaga"))}return!1;case"joinTraining4":if(14===t.results.length&&t.results[0].band_name){console.log("TRUTH CONDITION");for(var s=[],r=0;r<t.results.length;r++)s.push(t.results[r].band_name);return console.log(s),!!(s.includes("Limp Bizkit")&&s.includes("Waylon Jennings")&&s.includes("Guns N' Roses")&&s.includes("Phil Collins")&&s.includes("Madonna")&&s.includes("Coldplay")&&s.includes("The Who")&&s.includes("White Stripes")&&s.includes("Velvet Revolver")&&s.includes("Destiny's Child")&&s.includes("Black Flag")&&s.includes("Bee Gees")&&s.includes("Spinal Tap")&&s.includes("Tool"))}return!1;case"aggregateTraining1":if(1===t.results.length){for(var i=Object.values(t.results[0]),o=0;o<i.length;o++)if(/^288229/.test(i[o]))return!0;return!1}return!1;default:return!1}},k=(a(21),function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={query:"",results:[],error:"",sensei:"",senseiMessage:"",approvedQuery:""},a.handleChange=function(e){a.setState(Object(g.a)({},e.target.id,e.target.value))},a.handleSubmit=function(){var e=y(a.state.query);e.syntax?fetch(p+"/query",{body:JSON.stringify({query_statement:e.query}),method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(a.props.session)}}).then(function(e){return e.json()}).then(function(e){return a.handleResponse(e)}).catch(function(e){return console.log(e)}):a.setState({results:[],error:e.error})},a.handleResponse=function(e){e.syntax?a.setState({results:e.results,error:"",sensei:"",senseiMessage:"",approvedQuery:""}):!1===e.syntax?a.setState({results:[],error:a.handleErrors(e.error),sensei:"",senseiMessage:"",approvedQuery:""}):e.message?a.setState({results:[],error:"The SQL Sensei says: "+e.message,sensei:"",senseiMessage:"",approvedQuery:""}):a.setState({results:[],error:"The SQL Sensei doesn't like your query. Try again.",sensei:"",senseiMessage:"",approvedQuery:""})},a.handleErrors=function(e){if(/^PG/.test(e)){var t=e.toLowerCase();return"The SQL Sensei spots a syntax error: "+(t=t.replace(/\n/g," ").replace(/\\/g,"").replace(/"/g,"'")).split("error: ")[1].split(" line")[0]}return e},a.getTableHeaders=function(){return Object.keys(a.state.results[0])},a.renderTableHeaders=function(){return a.getTableHeaders().map(function(e,t){return s.a.createElement("th",{key:t},e)})},a.renderTableData=function(){for(var e=a.getTableHeaders(),t=[],n=0;n<a.state.results.length;n++){for(var r=[],i=0;i<e.length;i++)r.push(s.a.createElement("td",{key:i},a.state.results[n][e[i]]));t.push(s.a.createElement("tr",{key:n},r))}return t},a.checkWithTheSensei=function(e,t,n){(function(e,t,a){return S.apply(this,arguments)})(e,t,n).then(function(e){e?a.setState({sensei:"correct",senseiMessage:"The Sensei Says: CORRECT!",approvedQuery:a.state.query}):a.setState({sensei:"incorrect",senseiMessage:"The Sensei Says: INCORRECT! Try again.",approvedQuery:""})})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"query"},s.a.createElement("div",{id:"sensei-image-main"}),s.a.createElement("div",{id:"student-image-main"}),s.a.createElement("form",{id:"query-form"},s.a.createElement("textarea",{id:"query",type:"textarea",placeholder:"write your query",value:this.state.query,onChange:this.handleChange})),s.a.createElement("div",{className:"senseiMessage"},""!==this.state.sensei?s.a.createElement("h4",{className:this.state.sensei},this.state.senseiMessage):null),"correct"!==this.state.sensei?s.a.createElement("div",null,s.a.createElement("button",{onClick:function(){e.handleSubmit()}},"Test It"),s.a.createElement("button",{className:"button-primary",onClick:function(){e.checkWithTheSensei(e.props.training,e.state.query,e.props.session)}},"Prove Yourself to The SQL Sensei!")):s.a.createElement("button",{className:"button-primary"},"Save Correct Answer to your Ninja Moves!"),s.a.createElement("div",{className:"error"},""!==this.state.error?s.a.createElement("h5",null,this.state.error):null),s.a.createElement("div",{className:"results"},this.state.results.length>0?s.a.createElement("table",{id:"query-results"},s.a.createElement("thead",null,s.a.createElement("tr",null,this.renderTableHeaders())),s.a.createElement("tbody",null,this.renderTableData())):null))}}]),t}(n.Component)),O=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={training:"joinTraining1"},a.handleSelect=function(e){a.setState({training:e.target.value})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"training"},s.a.createElement("div",{className:"choose-move"},s.a.createElement("h4",null,"Choose Your Ninja Move"),s.a.createElement("select",{id:"moves-select",onChange:this.handleSelect},s.a.createElement("option",{value:"joinTraining1",default:!0},"Ninja Move 1"),s.a.createElement("option",{value:"joinTraining2"},"Ninja Move 2"),s.a.createElement("option",{value:"joinTraining3"},"Ninja Move 3"),s.a.createElement("option",{value:"joinTraining4"},"Ninja Move 4"))),s.a.createElement("div",{className:"training-summary"},s.a.createElement("div",{className:"situation"},s.a.createElement("h5",{id:"header"},"Situation"),s.a.createElement("h6",{id:"situation-content"},f(this.state.training).situationHeader),s.a.createElement(s.a.Fragment,null,f(this.state.training).situationBody.map(function(e,t){return s.a.createElement("p",{id:"situation-content",key:t},e)}))),s.a.createElement("div",{className:"ninja-moves"},s.a.createElement("h5",{id:"header"},"Your Ninja Moves"),s.a.createElement("p",{id:"situation-content"},f(this.state.training).ninjaMoves),s.a.createElement("a",{id:"postgres",target:"_blank",rel:"noopener noreferrer",href:"https://www.postgresql.org/docs/9.2/sql-syntax.html"},"PostgreSQL syntax only"))),s.a.createElement(k,{training:this.state.training,userId:this.props.userId,username:this.props.username,session:this.props.session}))}}]),t}(n.Component),I=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={training:"aggregateTraining1"},a.handleSelect=function(e){a.setState({training:e.target.value})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"training"},s.a.createElement("div",{className:"choose-move"},s.a.createElement("h4",null,"Choose Your Ninja Move"),s.a.createElement("select",{id:"moves-select",onChange:this.handleSelect},s.a.createElement("option",{value:"aggregateTraining1",default:!0},"Ninja Move 1"),s.a.createElement("option",{value:"aggregateTraining2"},"Ninja Move 2"),s.a.createElement("option",{value:"aggregateTraining3"},"Ninja Move 3"),s.a.createElement("option",{value:"aggregateTraining4"},"Ninja Move 4"))),s.a.createElement("div",{className:"training-summary"},s.a.createElement("div",{className:"situation"},s.a.createElement("h5",{id:"header"},"Situation"),s.a.createElement("h6",{id:"situation-content"},f(this.state.training).situationHeader),s.a.createElement(s.a.Fragment,null,f(this.state.training).situationBody.map(function(e,t){return s.a.createElement("p",{id:"situation-content",key:t},e)}))),s.a.createElement("div",{className:"ninja-moves"},s.a.createElement("h5",{id:"header"},"Your Ninja Moves"),s.a.createElement("p",{id:"situation-content"},f(this.state.training).ninjaMoves),s.a.createElement("a",{id:"postgres",target:"_blank",rel:"noopener noreferrer",href:"https://www.postgresql.org/docs/9.2/sql-syntax.html"},"PostgreSQL syntax only"))),s.a.createElement(k,{training:this.state.training,userId:this.props.userId,username:this.props.username,session:this.props.session}))}}]),t}(n.Component),M=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={skill:null,joinClass:"button",aggregateClass:"button"},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement(s.a.Fragment,null,s.a.createElement("h3",null,this.props.username," - Choose Your Ninja Skill!"),s.a.createElement("button",{id:"ninja-skill-button",className:this.state.joinClass,onClick:function(){e.setState({skill:"joins",joinClass:"button-secondary",aggregateClass:"button"})}},"Joins"),s.a.createElement("button",{id:"ninja-skill-button",className:this.state.aggregateClass,onClick:function(){e.setState({skill:"aggregate",joinClass:"button",aggregateClass:"button-secondary"})}},"Aggregate Functions"),"joins"===this.state.skill?s.a.createElement(O,{userId:this.props.userId,username:this.props.username,session:this.props.session}):null,"aggregate"===this.state.skill?s.a.createElement(I,{userId:this.props.userId,username:this.props.username,session:this.props.session}):null)}}]),t}(n.Component),q=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement("h1",null,"Your Saved Ninja Moves")}}]),t}(n.Component),x=(a(34),a(35),function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={userId:null,username:null,session:null},a.setSession=function(e){a.setState({userId:e.user_id,username:e.username,session:e.token}),localStorage.setItem("userId",a.state.userId),localStorage.setItem("username",a.state.username),localStorage.setItem("session",a.state.session)},a.logOut=function(){localStorage.clear(),a.setState({userId:null,username:null,session:null})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){null!==localStorage.getItem("session")&&this.setState({userId:localStorage.getItem("userId"),username:localStorage.getItem("username"),session:localStorage.getItem("session")})}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"app"},s.a.createElement("h1",{id:"title"},"SQL SENSEI"),null===this.state.session?s.a.createElement(v,{setSession:this.setSession}):s.a.createElement(d.a,null,s.a.createElement("nav",null,s.a.createElement("a",{id:"link",onClick:this.logOut,href:"/"},this.state.username," | Log Out"),s.a.createElement(d.b,{id:"link-cta",to:"/ninjamoves"},"Your Saved Ninja Moves")),s.a.createElement(h.a,{path:"/",exact:!0,render:function(t){return s.a.createElement(M,Object.assign({},t,{userId:e.state.userId,username:e.state.username,session:e.state.session}))}}),s.a.createElement(h.a,{path:"/ninjamoves",render:function(t){return s.a.createElement(q,Object.assign({},t,{userId:e.state.userId,username:e.state.username,session:e.state.session}))}})))}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(s.a.createElement(x,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[27,1,2]]]);
//# sourceMappingURL=main.548381ac.chunk.js.map